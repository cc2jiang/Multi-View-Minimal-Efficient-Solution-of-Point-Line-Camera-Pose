function [R_all,t_all] = recover_T_for_P1P2L(D_1,D_2,P2,L_3,L_4,R11,R21)
    R_all=[]; t_all=[];
    
    a_1=D_1(1); b_1=D_1(2);   a_2=D_2(1); b_2=D_2(2);   
    X_2=P2(1);   X_3=L_3(1);  Y_3=L_3(2); X_4=L_4(1);  Y_4=L_4(2); Z_4=L_4(3); 
    for i=1:4
        R31=(  (a_1-a_2)*R21(i)+(b_2-b_1)*R11(i)  )/(b_2*a_1-b_1*a_2);
        R22=( b_1*b_2*X_2*R11(i)+(b_1*a_2*X_3-b_2*a_1*X_3-b_1*a_2*X_2)*R21(i)  )/(Y_3*(b_2*a_1-b_1*a_2));
        R23=b_1*b_2*X_2*(Y_3-Y_4)*R11(i)/(  Y_3*Z_4*(b_2*a_1-b_1*a_2)  )+(  (X_3*Y_4-X_4*Y_3)/(Y_3*Z_4)+(b_1*a_2*X_2*Y_4-a_2*b_1*X_2*Y_3)/(Y_3*Z_4*(b_2*a_1-b_1*a_2))   )*R21(i);
        

        B=X_2*(a_2*R21(i)-b_2*R11(i))/(b_2*a_1-b_1*a_2);
        t_all(1,i)=a_1*B;
        t_all(2,i)=b_1*B;
        t_all(3,i)=-1+B;
    
        else_R=1/(R22^2+R23^2)*[-R11(i)*R21(i)*R22+R23*R31;
            -R11(i)*R21(i)*R23-R22*R31;
            -R21(i)*R22*R31-R11(i)*R23;
            -R21(i)*R23*R31+R11(i)*R22];
        
        R_all(:,:,i)=[R11(i),else_R(1),else_R(2);
              R21(i),R22,R23;
              R31,else_R(3),else_R(4)];
    end

end

